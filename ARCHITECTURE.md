# ğŸ—ï¸ è®¯é£IATè¯­éŸ³å¯¼èˆªç³»ç»Ÿ - ç³»ç»Ÿæ¶æ„

## æ€»ä½“è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   è®¯é£IATè¯­éŸ³å¯¼èˆªç³»ç»Ÿ                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   éº¦å…‹é£    â”‚      â”‚ WebSocket â”‚     â”‚  arecord  â”‚  â”‚
â”‚  â”‚  audio      â”‚      â”‚  æµå¼    â”‚     â”‚  æ–‡ä»¶    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜      â”‚  API      â”‚     â”‚  API      â”‚  â”‚
â”‚         â”‚             â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â”‚                    â”‚               â”‚        â”‚
â”‚         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚              â†“                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  speech_recognition_node.py (239è¡Œ)        â”‚        â”‚
â”‚  â”‚  - è¯†åˆ«å¼•æ“é€‰æ‹©ä¸ç®¡ç†                      â”‚        â”‚
â”‚  â”‚  - è®¯é£IAT WebSocketåè®®å®ç°               â”‚        â”‚
â”‚  â”‚  - HMAC-SHA256èº«ä»½éªŒè¯                     â”‚        â”‚
â”‚  â”‚  - å¤±è´¥è‡ªåŠ¨é™çº§æœºåˆ¶                        â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                   â†“                                    â”‚
â”‚        ROS Topic: /speech_recognition/text           â”‚
â”‚        â”Œâ”€ æ–‡æœ¬æ¶ˆæ¯ (UTF-8)                            â”‚
â”‚        â”‚                                              â”‚
â”‚        â†“                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  semantic_room_extractor.py (260è¡Œ)        â”‚        â”‚
â”‚  â”‚  - æˆ¿é—´å…³é”®è¯æå–                          â”‚        â”‚
â”‚  â”‚  - 8ç§æˆ¿é—´ç±»å‹,60+ åˆ«åæ”¯æŒ                â”‚        â”‚
â”‚  â”‚  - æ¨¡ç³ŠåŒ¹é…ç®—æ³•                            â”‚        â”‚
â”‚  â”‚  - ç½®ä¿¡åº¦åˆ†æ                              â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                   â†“                                    â”‚
â”‚        ROS Topic: /semantic_extraction/room          â”‚
â”‚        â”Œâ”€ æˆ¿é—´ä¿¡æ¯ (type, name, confidence)         â”‚
â”‚        â”‚                                              â”‚
â”‚        â†“                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  voice_nav_manager.py (363è¡Œ)              â”‚        â”‚
â”‚  â”‚  - åœ°å›¾ç‰ˆæœ¬è‡ªåŠ¨å‘ç°                        â”‚        â”‚
â”‚  â”‚  - æˆ¿é—´â†’åæ ‡æ˜ å°„                           â”‚        â”‚
â”‚  â”‚  - åƒç´ â†’ç±³åæ ‡è½¬æ¢                         â”‚        â”‚
â”‚  â”‚  - å¯¼èˆªç›®æ ‡å‘é€                            â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                   â†“                                    â”‚
â”‚        ROS Topic: /move_base_simple/goal              â”‚
â”‚        â”Œâ”€ PoseStamped (x, y, orientation)           â”‚
â”‚        â”‚                                              â”‚
â”‚        â†“                                              â”‚
â”‚   ğŸ¤– ROSå¯¼èˆªå †æ ˆ (move_base)                         â”‚
â”‚   â†“ è·¯å¾„è§„åˆ’ã€é¿éšœã€è¿åŠ¨æ§åˆ¶                         â”‚
â”‚   ğŸ¯ æœºå™¨äººå¯¼èˆªåˆ°ç›®æ ‡æˆ¿é—´                             â”‚
â”‚                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ ¸å¿ƒæ¨¡å—è¯¦è§£

### 1ï¸âƒ£ speech_recognition_node.py (239è¡Œ)

**èŒè´£:** è®¯é£IATè¯­éŸ³è¯†åˆ«å¼•æ“

#### ç±»: `XfyunIATRecognizer`

**åˆå§‹åŒ–æµç¨‹:**
```python
__init__()
â”œâ”€ æ£€æŸ¥è®¯é£å‡­è¯ (XFYUN_APP_ID, XFYUN_API_KEY)
â”œâ”€ æ£€æµ‹å¯ç”¨ç¯å¢ƒ:
â”‚  â”œâ”€ PyAudio + WebSocket ä¼˜å…ˆ (å®æ—¶æµå¼)
â”‚  â””â”€ arecord + API å¤‡é€‰ (æ–‡ä»¶å¼)
â””â”€ åˆå§‹åŒ–ROSå‘å¸ƒè€…
```

**æ ¸å¿ƒæ–¹æ³•:**

| æ–¹æ³• | ä½œç”¨ | è¿”å›å€¼ |
|------|------|--------|
| `run()` | ä¸»å¾ªç¯,è·¯ç”±åˆ°åˆé€‚çš„è¯†åˆ«æ–¹æ³• | - |
| `_run_with_websocket()` | å®æ—¶WebSocketæµå¼è¯†åˆ« | - |
| `_run_with_arecord()` | æ–‡ä»¶å¼è¯†åˆ«å¤‡é€‰æ–¹æ¡ˆ | - |
| `_get_auth_header()` | ç”ŸæˆHMAC-SHA256è®¤è¯ | str |
| `_recognize_with_api()` | APIè°ƒç”¨æ¥å£ | dict |

**WebSocketæµç¨‹:**
```
è¿æ¥ wss://iat-api.xfyun.cn/v2/iat
  â†“
å‘é€JSONåˆå§‹åŒ–å¸§ (å¸¦HMAC-SHA256è®¤è¯)
  â†“
æµå¼å‘é€éŸ³é¢‘å¸§
  â”œâ”€ status: 0 (å¼€å§‹)
  â”œâ”€ status: 1 (ä¸­é—´)
  â””â”€ status: 2 (ç»“æŸ)
  â†“
æ¥æ”¶JSONå“åº”
  â”œâ”€ ä¸´æ—¶è¯†åˆ«ç»“æœ
  â”œâ”€ æœ€ç»ˆè¯†åˆ«ç»“æœ
  â””â”€ é”™è¯¯ä¿¡æ¯
  â†“
å‘å¸ƒROSä¸»é¢˜ /speech_recognition/text
```

**èº«ä»½éªŒè¯ (HMAC-SHA256):**
```python
timestamp = str(int(time.time()))
signature = HMAC-SHA256(
    key=API_KEY,
    message=timestamp
)
auth_header = f'api_key="{APP_ID}", algorithm="hmac-sha256", timestamp="{timestamp}", signature="{signature}"'
```

**éŸ³é¢‘å‚æ•°:**
- é‡‡æ ·ç‡: 16000 Hz
- ä½æ·±: 16 bit
- é€šé“: Mono (å•å£°é“)
- å¸§å¤§å°: 1024 å­—èŠ‚
- ç¼–ç : L16 (Little-endian 16-bit PCM)

### 2ï¸âƒ£ semantic_room_extractor.py (260è¡Œ)

**èŒè´£:** æˆ¿é—´è¯­ä¹‰æå–

#### æˆ¿é—´ç±»å‹æ˜ å°„ (8ç±»)

```python
ROOM_TYPES = {
    "living_room": ["å®¢å…", "å¤§å…", "èµ·å±…å®¤", ...],      # 8ä¸ªåˆ«å
    "bedroom": ["å§å®¤", "æˆ¿é—´", "ç¡æˆ¿", ...],             # 6ä¸ªåˆ«å
    "kitchen": ["å¨æˆ¿", "çƒ¹é¥ªé—´", "ç¶é—´", ...],           # 5ä¸ªåˆ«å
    "bathroom": ["å«ç”Ÿé—´", "æµ´å®¤", "æ´—æ‰‹é—´", ...],        # 7ä¸ªåˆ«å
    "study": ["ä¹¦æˆ¿", "å­¦ä¹ å®¤", "ä¹¦æ–‹", ...],             # 4ä¸ªåˆ«å
    "dining_room": ["é¤å…", "é¥­å…", "å°±é¤åŒº", ...],       # 4ä¸ªåˆ«å
    "hallway": ["èµ°å»Š", "è¿‡é“", "é—¨å…", ...],             # 3ä¸ªåˆ«å
    "office": ["åŠå…¬å®¤", "å·¥ä½œå®¤", "åŠå…¬é—´", ...]         # 4ä¸ªåˆ«å
}
```

**åŒ¹é…ç®—æ³•:**

1. **ç²¾ç¡®åŒ¹é…** (ä¼˜å…ˆçº§æœ€é«˜)
   ```python
   if text in room_list:
       return (room_type, confidence=1.0)
   ```

2. **æ¨¡ç³ŠåŒ¹é…** (å®¹é”™)
   - ç¼–è¾‘è·ç¦» â‰¤ 2
   - éƒ¨åˆ†å­—ç¬¦åŒ¹é…
   - æ‹¼éŸ³ç›¸ä¼¼åº¦

3. **ç½®ä¿¡åº¦è¯„åˆ†**
   ```python
   confidence = 1.0 - (edit_distance / max_length)
   # å¦‚æœ confidence â‰¥ 0.7 åˆ™è®¤ä¸ºåŒ¹é…æˆåŠŸ
   ```

**è¾“å‡ºæ¶ˆæ¯ç»“æ„:**
```python
{
    "room_type": "living_room",      # æˆ¿é—´ç±»å‹ (8ç§ä¹‹ä¸€)
    "room_name": "å®¢å…",              # è¯†åˆ«å‡ºçš„å…·ä½“åç§°
    "confidence": 0.95,               # ç½®ä¿¡åº¦ (0-1)
    "matched_keyword": "å®¢å…",        # åŒ¹é…çš„å…³é”®è¯
    "original_text": "å»å®¢å…"         # åŸå§‹è¯†åˆ«æ–‡æœ¬
}
```

### 3ï¸âƒ£ voice_nav_manager.py (363è¡Œ)

**èŒè´£:** åœ°å›¾ç®¡ç†ä¸å¯¼èˆªç›®æ ‡å‘é€

#### åœ°å›¾è‡ªåŠ¨å‘ç°æœºåˆ¶

```
æ‰«æåœ°å›¾æ–‡ä»¶:
â”œâ”€ map_v1.yaml / map_v1.pgm
â”œâ”€ map_v2.yaml / map_v2.pgm
â”œâ”€ map_v3.yaml / map_v3.pgm
â””â”€ map.yaml / map.pgm

æ£€æŸ¥YAMLé…ç½®:
â”œâ”€ resolution (åˆ†è¾¨ç‡)
â”œâ”€ origin (åŸç‚¹åæ ‡)
â”œâ”€ negate (é¢œè‰²åè½¬)
â””â”€ occupied_thresh (å ç”¨é˜ˆå€¼)

åŠ è½½æˆ¿é—´åæ ‡è¡¨:
â””â”€ map_rooms.txt (æ ¼å¼: room_name x y)
```

#### æˆ¿é—´â†’å¯¼èˆªç›®æ ‡è½¬æ¢

**è¾“å…¥:**
```python
{
    "room_type": "living_room",
    "room_name": "å®¢å…",
    "confidence": 0.95
}
```

**å¤„ç†:**
1. æŸ¥è¯¢æˆ¿é—´åæ ‡è¡¨ â†’ (pixel_x, pixel_y)
2. è½¬æ¢ä¸ºä¸–ç•Œåæ ‡:
   ```python
   world_x = (pixel_x * resolution) + origin_x
   world_y = (pixel_y * resolution) + origin_y
   ```
3. è®¾ç½®æœå‘ (orientation) = 0 (é¢å‘åŒ—)
4. ç”Ÿæˆå¯¼èˆªç›®æ ‡æ¶ˆæ¯

**è¾“å‡º:**
```python
PoseStamped {
    header: {
        frame_id: "map",
        stamp: current_time
    },
    pose: {
        position: {
            x: 5.2,           # ç±³
            y: 3.8,           # ç±³
            z: 0.0
        },
        orientation: {
            x: 0.0,
            y: 0.0,
            z: 0.0,           # sin(Î¸/2)
            w: 1.0            # cos(Î¸/2)
        }
    }
}
```

## æ•°æ®æµä¸æ¶ˆæ¯ç±»å‹

### Topic å®šä¹‰

| Topic | ç±»å‹ | æ–¹å‘ | å«ä¹‰ |
|-------|------|------|------|
| `/speech_recognition/text` | std_msgs/String | Pub | è®¯é£IATè¯†åˆ«ç»“æœ |
| `/semantic_extraction/room` | nav_msgs/RoomInfo* | Pub | æå–çš„æˆ¿é—´ä¿¡æ¯ |
| `/move_base_simple/goal` | geometry_msgs/PoseStamped | Pub | ROSå¯¼èˆªç›®æ ‡ |

*æ³¨: RoomInfoä¸ºè‡ªå®šä¹‰æ¶ˆæ¯

### æ¶ˆæ¯æµè½¬ç¤ºä¾‹

**ç¤ºä¾‹: ç”¨æˆ·è¯´"æˆ‘è¦å»å®¢å…"**

```
â”Œâ”€ ç”¨æˆ·è¯´: "æˆ‘è¦å»å®¢å…"
â”‚
â”œâ”€ speech_recognition_node æ¥æ”¶å¹¶è¯†åˆ«
â”‚  â””â”€ WebSocket â†’ è®¯é£IAT
â”‚     â””â”€ è¯†åˆ«ç»“æœ: "æˆ‘è¦å»å®¢å…"
â”‚
â”œâ”€ å‘å¸ƒ: /speech_recognition/text = "æˆ‘è¦å»å®¢å…"
â”‚
â”œâ”€ semantic_room_extractor è®¢é˜…å¹¶å¤„ç†
â”‚  â””â”€ æå–å…³é”®è¯: "å®¢å…" â†’ room_type="living_room"
â”‚
â”œâ”€ å‘å¸ƒ: /semantic_extraction/room = {
â”‚       "room_type": "living_room",
â”‚       "room_name": "å®¢å…",
â”‚       "confidence": 0.95
â”‚  }
â”‚
â”œâ”€ voice_nav_manager è®¢é˜…å¹¶å¤„ç†
â”‚  â””â”€ æŸ¥è¯¢åœ°å›¾: "living_room" â†’ (pixel: 120, 95)
â”‚     è½¬æ¢åæ ‡: â†’ (world: 5.2m, 3.8m)
â”‚
â”œâ”€ å‘å¸ƒ: /move_base_simple/goal = PoseStamped(x=5.2, y=3.8)
â”‚
â””â”€ ROS move_base æ¥æ”¶
   â””â”€ è·¯å¾„è§„åˆ’ â†’ é¿éšœ â†’ è¿åŠ¨æ§åˆ¶
      â””â”€ ğŸ¤– æœºå™¨äººå¯¼èˆªåˆ°å®¢å…
```

## é”™è¯¯å¤„ç†ä¸é™çº§æœºåˆ¶

### è®¯é£IAT è¯†åˆ«å¤±è´¥

```
å°è¯• WebSocket è¯†åˆ«
    â†“
å¤±è´¥ (ç½‘ç»œ/APIé”™è¯¯)
    â†“
é™çº§åˆ° arecord + API æ–¹å¼
    â†“
ä»ç„¶å¤±è´¥
    â†“
è®°å½•é”™è¯¯æ—¥å¿—,ç»§ç»­ç­‰å¾…ä¸‹ä¸€å¥
```

### æˆ¿é—´è¯†åˆ«å¤±è´¥

```
text = "å»æŸæŸåœ°æ–¹" (æ— æ³•è¯†åˆ«æˆ¿é—´)
    â†“
semantic_extractor æ‰¾ä¸åˆ°åŒ¹é…çš„æˆ¿é—´
    â†“
å‘å¸ƒæ¶ˆæ¯: confidence = 0.0
    â†“
voice_nav_manager çœ‹åˆ°ä½ç½®ä¿¡åº¦
    â†“
ä¸å‘é€å¯¼èˆªå‘½ä»¤,ç­‰å¾…ç”¨æˆ·é‡æ–°è¯´è¯
    â†“
æ—¥å¿—: "Unknown room: æŸæŸåœ°æ–¹"
```

### åœ°å›¾åŠ è½½å¤±è´¥

```
å¯åŠ¨ voice_nav_manager
    â†“
æ‰«æåœ°å›¾æ–‡ä»¶
    â†“
æ‰¾ä¸åˆ°æœ‰æ•ˆåœ°å›¾ (map.yaml / map_v1.yaml ç­‰)
    â†“
é”™è¯¯: "No valid map found at ..."
    â†“
èŠ‚ç‚¹é€€å‡º (æ— æ³•å¯¼èˆª)
```

**è§£å†³æ–¹æ¡ˆ:** ç¡®ä¿å­˜åœ¨ä»¥ä¸‹æ–‡ä»¶ä¹‹ä¸€:
- `src/nav_pkg/maps/map.yaml` å’Œ `map.pgm`
- `src/nav_pkg/maps/map_v1.yaml` å’Œ `map_v1.pgm`

## é…ç½®æ–‡ä»¶

### voice_nav_params.yaml (34ä¸ªå‚æ•°)

**è®¯é£IATé…ç½®:**
```yaml
xfyun:
  app_id: "${XFYUN_APP_ID}"
  api_key: "${XFYUN_API_KEY}"
  language: "zh_CN"              # zh_CN æˆ– en_US
  domain: "iat"                  # è¯­éŸ³å¬å†™
  vad_eos: 5000                  # é™éŸ³è¶…æ—¶ (æ¯«ç§’)
  accent: "mandarin"             # å£éŸ³ç±»å‹
```

**æˆ¿é—´æå–é…ç½®:**
```yaml
semantic_extraction:
  threshold: 0.7                 # ç½®ä¿¡åº¦é˜ˆå€¼
  enable_fuzzy: true             # å¯ç”¨æ¨¡ç³ŠåŒ¹é…
  fuzzy_threshold: 0.8           # æ¨¡ç³ŠåŒ¹é…é˜ˆå€¼
```

**å¯¼èˆªé…ç½®:**
```yaml
navigation:
  map_dir: "/home/robot/catkin_ws/src/nav_pkg/maps"
  default_map: "map.yaml"        # é»˜è®¤åœ°å›¾
  auto_discover: true            # è‡ªåŠ¨å‘ç°åœ°å›¾ç‰ˆæœ¬
  frame_id: "map"                # åæ ‡ç³»
```

## ROSèŠ‚ç‚¹å¯åŠ¨é¡ºåº

```
roslaunch nav_pkg voice_nav_simple.launch
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. roscor (ROS æ ¸å¿ƒ)                 â”‚
â”‚ 2. speech_recognition_node           â”‚
â”‚ 3. semantic_room_extractor           â”‚
â”‚ 4. voice_nav_manager                 â”‚
â”‚ 5. (å¯é€‰) RViz å¯è§†åŒ–                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
æ‰€æœ‰èŠ‚ç‚¹å°±ç»ª,ç­‰å¾…éŸ³é¢‘è¾“å…¥
```

**èŠ‚ç‚¹ä¾èµ–å…³ç³»:**

```
speech_recognition_node (æ— ä¾èµ–)
    â”‚
    â”œâ”€ /speech_recognition/text
    â”‚
    â†“
semantic_room_extractor (è®¢é˜… /speech_recognition/text)
    â”‚
    â”œâ”€ /semantic_extraction/room
    â”‚
    â†“
voice_nav_manager (è®¢é˜… /semantic_extraction/room)
    â”‚
    â”œâ”€ /move_base_simple/goal
    â”‚
    â†“
move_base (è®¢é˜… /move_base_simple/goal) [å¯é€‰,é€šè¿‡launchæ–‡ä»¶å¯ç”¨]
```

## æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | ç›®æ ‡ | å®ç° |
|------|------|------|
| è¯­éŸ³è¯†åˆ«å»¶è¿Ÿ | < 2ç§’ | WebSocketæµå¼å¤„ç† |
| æˆ¿é—´æå–å»¶è¿Ÿ | < 100ms | æœ¬åœ°æ¨¡ç³ŠåŒ¹é… |
| å¯¼èˆªå‘é€å»¶è¿Ÿ | < 50ms | ç›´æ¥åæ ‡æŸ¥è¯¢ |
| **æ€»å»¶è¿Ÿ** | < 3ç§’ | å®æ—¶æµå¼è¯†åˆ« |
| å†…å­˜å ç”¨ | < 50MB | è½»é‡çº§å®ç° |
| CPUå ç”¨ | < 10% | å•çº¿ç¨‹ROSèŠ‚ç‚¹ |

## æ‰©å±•æ€§è®¾è®¡

### æ”¯æŒæ–°æˆ¿é—´ç±»å‹

**æ­¥éª¤ 1:** ä¿®æ”¹ `semantic_room_extractor.py`

```python
ROOM_TYPES = {
    ...
    "garage": ["è½¦åº“", "åœè½¦ä½", "garage"],          # æ–°å¢
    "gym": ["å¥èº«æˆ¿", "é”»ç‚¼å®¤", "gym"],              # æ–°å¢
}
```

**æ­¥éª¤ 2:** åœ¨ `map_rooms.txt` ä¸­æ·»åŠ åæ ‡

```
garage 150 95
gym 200 120
```

### æ”¯æŒæ–°çš„è¯­è¨€

ä¿®æ”¹ `voice_nav_params.yaml`:

```yaml
xfyun:
  language: "en_US"              # è‹±æ–‡
```

æˆ–åŠ¨æ€é…ç½®:

```python
# åœ¨ speech_recognition_node.py ä¸­
self.language = rospy.get_param('~language', 'zh_CN')
```

### æ·»åŠ è‡ªå®šä¹‰è¯†åˆ«åå¤„ç†

åœ¨ `voice_nav_manager.py` ä¸­æ‰©å±•:

```python
def _preprocess_room_name(self, room_name):
    """è‡ªå®šä¹‰æˆ¿é—´åç§°é¢„å¤„ç†"""
    # ä¾‹å¦‚: "è€ç‹çš„å§å®¤" â†’ "å§å®¤"
    # ä¾‹å¦‚: "ä¹¦æˆ¿é‡Œçš„ä¹¦" â†’ "ä¹¦æˆ¿"
    return processed_name
```

---

## æ€»ç»“

- **æ¨¡å—åŒ–è®¾è®¡**: 3ä¸ªç‹¬ç«‹çš„ROSèŠ‚ç‚¹,å„å¸å…¶èŒ
- **è‡ªåŒ…å«å®ç°**: æ— å¤–éƒ¨ä¾èµ–,å®Œæ•´çš„è®¯é£IATåè®®å®ç°
- **æ˜“äºæ‰©å±•**: æ”¯æŒæ–°æˆ¿é—´ã€æ–°è¯­è¨€ã€è‡ªå®šä¹‰å¤„ç†
- **é²æ£’æ€§**: å¤šå±‚é”™è¯¯å¤„ç†å’Œé™çº§æœºåˆ¶
- **è½»é‡çº§**: æ€»ä»£ç  862 è¡Œ,å†…å­˜å ç”¨ < 50MB

---

**éœ€è¦æ›´æ·±å…¥çš„æŠ€æœ¯ç»†èŠ‚ï¼Ÿ** æŸ¥çœ‹å„ä¸ªæ¨¡å—çš„æºä»£ç æ³¨é‡Šï¼

